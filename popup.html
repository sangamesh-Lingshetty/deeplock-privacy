<!doctype html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>DeepLock</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=DM+Sans:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="popup.css" />
  </head>
  <body>
    <div class="app">
      <!-- HEADER -->
      <div class="header">
        <div class="logo">
          <span class="logo-icon">‚¨õ</span>
          <span class="logo-text">DeepLock</span>
        </div>
        <div class="header-right">
          <div id="probadge" class="pro-badge" style="display: none">PRO</div>
          <button class="icon-btn" id="dashboardBtn" title="Dashboard">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
              <rect
                x="1"
                y="1"
                width="6"
                height="6"
                rx="1"
                fill="currentColor"
                opacity="0.9"
              />
              <rect
                x="9"
                y="1"
                width="6"
                height="6"
                rx="1"
                fill="currentColor"
                opacity="0.5"
              />
              <rect
                x="1"
                y="9"
                width="6"
                height="6"
                rx="1"
                fill="currentColor"
                opacity="0.5"
              />
              <rect
                x="9"
                y="9"
                width="6"
                height="6"
                rx="1"
                fill="currentColor"
                opacity="0.9"
              />
            </svg>
          </button>
        </div>
      </div>

      <!-- ======================== -->
      <!-- INACTIVE STATE -->
      <!-- ======================== -->
      <div id="inactive">
        <div class="focus-header">
          <p class="focus-question">What are you building today?</p>
        </div>

        <textarea
          id="focusIntent"
          placeholder="e.g. Finish the landing page, study for exam..."
          maxlength="100"
          rows="2"
        ></textarea>

        <!-- TIME SELECTION -->
        <div class="time-grid">
          <button class="time-btn" data-min="25">25<span>min</span></button>
          <button class="time-btn" data-min="45">45<span>min</span></button>
          <button class="time-btn" data-min="60">60<span>min</span></button>
          <button class="time-btn" data-min="90">90<span>min</span></button>
          <button class="time-btn pro-gate" data-min="120" id="btn120">
            120<span>min</span>
            <span class="pro-lock">PRO</span>
          </button>
          <button class="time-btn pro-gate custom-time-btn" id="btnCustom">
            Custom<span>min</span>
            <span class="pro-lock">PRO</span>
          </button>
        </div>

        <!-- Custom time (Pro only) -->
        <div id="customTimeRow" style="display: none">
          <input
            type="number"
            id="customMinInput"
            min="1"
            max="480"
            placeholder="Enter minutes (1‚Äì480)"
            class="custom-input"
          />
        </div>

        <button id="startBtn" class="start-btn" disabled>
          <span id="startLabel">Select a time to lock in</span>
        </button>

        <!-- QUICK STATS STRIP -->
        <div class="stats-strip" id="statsStrip">
          <div class="stat-pill">
            <span class="stat-num" id="stripSessions">0</span>
            <span class="stat-label">sessions</span>
          </div>
          <div class="stat-divider"></div>
          <div class="stat-pill">
            <span class="stat-num" id="stripHours">0h</span>
            <span class="stat-label">focused</span>
          </div>
          <div class="stat-divider"></div>
          <div class="stat-pill streak-pill">
            <span class="stat-num" id="stripStreak">0</span>
            <span class="stat-label">day streak üî•</span>
          </div>
        </div>

        <div class="blocks-info" id="blocksInfo">
          <span class="blocks-dot"></span>
          <span id="blocksText">Loading...</span>
        </div>

        <!-- FREE SESSION LIMIT BAR -->
        <div
          id="sessionLimitBar"
          class="session-limit-bar"
          style="display: none"
        >
          <div class="limit-pips">
            <span class="limit-pip"></span>
            <span class="limit-pip"></span>
          </div>
          <span class="limit-label">2 free sessions left today</span>
        </div>
      </div>

      <!-- ======================== -->
      <!-- ACTIVE SESSION STATE -->
      <!-- ======================== -->
      <div id="active" style="display: none">
        <div class="session-live">
          <div class="live-dot-wrap">
            <span class="live-dot"></span>
            <span class="live-label">SESSION LIVE</span>
          </div>

          <div class="session-intent" id="sessionIntent"></div>

          <div class="timer-ring-wrap">
            <svg class="timer-ring" viewBox="0 0 120 120">
              <circle cx="60" cy="60" r="52" class="ring-bg" />
              <circle
                cx="60"
                cy="60"
                r="52"
                class="ring-progress"
                id="ringProgress"
              />
            </svg>
            <div class="timer-center">
              <div class="timer-time" id="timer">--:--</div>
              <div class="timer-sub">remaining</div>
            </div>
          </div>

          <div class="session-blocked-row">
            <span id="sessionBlockCount">0</span> sites blocked
          </div>

          <div class="hardcore-notice">
            <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
              <path
                d="M6 1L7.545 4.09L11 4.618L8.5 7.045L9.09 10.5L6 8.955L2.91 10.5L3.5 7.045L1 4.618L4.455 4.09L6 1Z"
                fill="currentColor"
              />
            </svg>
            Cannot stop. Stay locked in.
          </div>
        </div>
      </div>

      <!-- ======================== -->
      <!-- PRO UPGRADE SECTION -->
      <!-- ======================== -->
      <div id="proSection">
        <!-- FREE: upgrade CTA -->
        <div id="freeProSection" class="pro-cta">
          <div class="pro-cta-top">
            <div class="pro-cta-label">DEEPLOCK PRO</div>
            <div class="pro-cta-price">‚Çπ499<span>/year</span></div>
          </div>
          <ul class="pro-features">
            <li><span class="feat-icon">‚ö°</span> Custom site blocking</li>
            <li><span class="feat-icon">üìä</span> Full analytics dashboard</li>
            <li>
              <span class="feat-icon">üî•</span> Streak sync across devices
            </li>
            <li>
              <span class="feat-icon">‚è±</span> Unlimited sessions + durations
            </li>
          </ul>
          <button id="upgradeBtn" class="upgrade-btn">
            Unlock Pro ‚Äî ‚Çπ499/year
          </button>
          <div class="license-section">
            <p class="license-hint">
              Already purchased? Enter your license key:
            </p>
            <div class="license-row">
              <input
                type="text"
                id="licenseKeyInput"
                placeholder="XXXX-XXXX-XXXX-XXXX"
                class="license-input"
                spellcheck="false"
                autocomplete="off"
              />
              <button id="activateBtn" class="activate-btn">Activate</button>
            </div>
            <div id="licenseFeedback" class="license-feedback"></div>
          </div>
        </div>

        <!-- PRO: custom sites (compact) -->
        <div
          id="customSitesSection"
          style="display: none"
          class="custom-sites-section"
        >
          <div class="cs-header">
            <span>Custom Blocked Sites</span>
            <button id="addSiteBtn" class="add-site-btn">+ Add</button>
          </div>
          <!-- Suggestions strip ‚Äî shown when adding -->
          <div
            id="siteSuggestions"
            class="site-suggestions"
            style="display: none"
          >
            <div class="suggestions-grid" id="suggestionsGrid"></div>
            <div class="manual-site-row">
              <input
                id="manualSitePopup"
                class="manual-site-input"
                placeholder="or type a domain‚Ä¶"
              />
              <button id="manualSiteAdd" class="manual-site-btn">Add</button>
            </div>
          </div>
          <div id="siteList" class="site-list"></div>
        </div>
      </div>

      <!-- MOTIVATOR ‚Äî shown when not locked, rotates daily -->
      <div class="motivator" id="motivator" style="display: none">
        <span class="motivator-text" id="motivatorText"></span>
      </div>

      <!-- FOOTER ‚Äî Dashboard for Pro, support always visible -->
      <div class="footer">
        <button
          id="dashboardLink"
          class="footer-dashboard"
          style="display: none"
        >
          Open Dashboard ‚Üí
        </button>
        <button id="supportBtn" class="footer-support">Support</button>
      </div>

      <!-- SMART UPGRADE MODAL -->
      <div id="upgradeModal" class="modal-overlay" style="display: none">
        <div class="modal">
          <!-- Context badge ‚Äî changes based on trigger -->
          <div class="modal-context-badge" id="modalBadge">PRO FEATURE</div>

          <!-- Streak hero ‚Äî only shown when streak > 0 -->
          <div
            class="modal-streak-hero"
            id="modalStreakHero"
            style="display: none"
          >
            <div class="modal-streak-fire">üî•</div>
            <div class="modal-streak-num" id="modalStreakNum">0</div>
            <div class="modal-streak-label">day streak</div>
          </div>

          <!-- Icon ‚Äî shown when no streak -->
          <div class="modal-emoji" id="modalEmoji">‚ö°</div>

          <!-- Title ‚Äî changes by context -->
          <div class="modal-title" id="modalTitle">Unlock Pro</div>

          <!-- Body ‚Äî changes by context -->
          <div class="modal-body" id="modalBody">
            Get unlimited sessions, custom site blocking, and full analytics.
          </div>

          <!-- Feature bullets ‚Äî shown on limit trigger -->
          <div class="modal-features" id="modalFeatures" style="display: none">
            <div class="modal-feat">
              <span>‚àû</span> Unlimited daily sessions
            </div>
            <div class="modal-feat">
              <span>üéØ</span> Custom sites + app blocking
            </div>
            <div class="modal-feat">
              <span>üìä</span> Full analytics dashboard
            </div>
            <div class="modal-feat">
              <span>üî•</span> Streak sync across devices
            </div>
          </div>

          <!-- Price + CTA -->
          <div class="modal-price-row">
            <div class="modal-price">‚Çπ499<span>/year</span></div>
            <div class="modal-per-day">Less than ‚Çπ2/day</div>
          </div>

          <button id="modalUpgradeBtn" class="upgrade-btn modal-cta">
            Unlock Pro Now ‚Üí
          </button>

          <!-- 7-day offer ‚Äî only shown after 7 days -->
          <div class="modal-offer" id="modalOffer" style="display: none">
            <span class="offer-tag">FIRST WEEK ONLY</span>
            Use code <strong id="offerCode">EARLYBIRD</strong> for 20% off
          </div>

          <button id="modalCloseBtn" class="modal-close">Not now</button>
        </div>
      </div>
    </div>

    <script src="popup.js"></script>
  </body>
</html>
